Имеется два типа запросов, которые поступают в единую точку входа. Запросы типа А и В, у каждого запроса есть признак Х, который является числом (для простоты int). Запросы разных типов должны обрабатываться строго параллельно, т.е. в очередь запросов типа А, не должны попадать запросы типа В. Запросы с одним и тем же значением признака Х должны выполняться строго последовательно. Т.е., если к нам приходит запрос типа А с Х = 10 (например), а потом приходит запрос типа А или В с Х = 10, то второй запрос должен дождаться окончания выполнения первого и наоборот. При этом запросы одного типа с разным значением признака могут (и по возможности, должны) выполняться параллельно.